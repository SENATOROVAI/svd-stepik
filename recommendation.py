import numpy as np

# Матрица рейтингов: строки - пользователи, столбцы - фильмы
# 0 означает отсутствие рейтинга
R = np.array([
    [5, 3, 0, 1],
    [4, 0, 0, 1],
    [1, 1, 0, 5],
    [1, 0, 0, 4],
    [0, 1, 5, 4],
])

# Применяем SVD
U, s, Vt = np.linalg.svd(R, full_matrices=False)

# Реконструируем матрицу с помощью k-сингулярных значений (например, k=2)
k = 2
S = np.diag(s[:k])
R_approx = U[:, :k] @ S @ Vt[:k, :]

print("Прогноз рейтинга пользователя 0 на фильм 2:", round(R_approx[0, 2], 2))
